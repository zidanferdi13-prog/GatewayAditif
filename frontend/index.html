<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loadcell Monitor</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
</head>
<body>
  <div class="container">
    <!-- Connection Status -->
    <button id="input-mo" class="status-mo disconnected">
      <span id="nomorMO"><i>INPUT - MO</i></span>
    </button>

    <div class="status-lot">
      <span id="lotText"><i>LOT: 0 / 48</i></span>
    </div>

    <div id="connectionStatus" class="status-badge disconnected">
      <span class="status-dot"></span>
      <span id="statusText">Disconnected</span>
    </div>

    <!-- Live Weight Display -->
    <div class="weight-display">
      <div class="weight-label" id="materialBahan">Bahan Material</div>
      <div class="weight-row">
        <div class="weight-value" id="liveWeight">--</div>
        <div class="weight-target" id="targetWeight">--</div>
      </div>
      <div class="weight-unit">kg</div>
    </div>

    <!-- Timestamp -->
    <div class="timestamp" id="lastUpdate">Waiting for data...</div>
    <button id="printBtn" class="print-button">Print</button>
  </div>

  <!-- Modal Popup Input MO -->
  <div id="moModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Input Nomor MO</h2>
      </div>
      <div class="modal-body">
        <p>Timbangan sudah mendeteksi berat!</p>
        <p>Silakan input nomor MO terlebih dahulu</p>
        <input type="text" id="moInputField" placeholder="Masukan Nomor MO..." maxlength="50">
      </div>
      <div class="modal-footer">
        <button id="moSubmitBtn" class="btn-submit">Submit</button>
        <button id="moCancelBtn" class="btn-cancel">Cancel</button>
      </div>
    </div>
  </div>
  
  <!-- Modal Konfirmasi Reset MO -->
  <div id="confirmResetModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Reset MO</h2>
      </div>
      <div class="modal-body">
        <p>Apakah Anda yakin ingin mereset MO?</p>
        <p>MO saat ini: <strong id="currentMODisplay"></strong></p>
      </div>
      <div class="modal-footer">
        <button id="confirmResetBtn" class="btn-submit">Reset</button>
        <button id="cancelResetBtn" class="btn-cancel">Batal</button>
      </div>
    </div>
  </div>
  
  <!-- Modal Alert Overload -->
  <div id="alertOverloadModal" class="modal">
    <div class="modal-content modal-warning">
      <div class="modal-header">
        <h2>‚ö†Ô∏è PERINGATAN</h2>
      </div>
      <div class="modal-body">
        <p style="font-size: 16px; font-weight: bold; color: var(--danger-color);">Berat melebihi target!</p>
        <div style="margin-top: 20px; text-align: left;">
          <p>Berat saat ini: <strong id="overloadWeight" style="color: var(--primary-color);">0.00</strong> kg</p>
          <p>Target: <strong id="overloadTarget" style="color: var(--text-secondary);">0.00</strong> kg</p>
        </div>
      </div>
      <div class="modal-footer">
        <button id="overloadOkBtn" class="btn-submit">OK</button>
      </div>
    </div>
  </div>

  <!-- Modal Konfirmasi Data MO dari API -->
  <div id="moDataConfirmModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>üìã Konfirmasi Data MO</h2>
      </div>
      <div class="modal-body" style="text-align: left;">
        <p><strong>Nomor MO:</strong> <span id="confirmMONumber"></span></p>
        <p><strong>Total Lot:</strong> <span id="confirmTotalLot"></span></p>
        <p><strong>Jumlah Produk RM:</strong> <span id="confirmRMCount"></span></p>
        <hr style="margin: 15px 0; border: 1px solid #334155;">
        <h3 style="margin-bottom: 10px; color: var(--primary-color);">Detail Produk RM:</h3>
        <div id="confirmRMDetails" style="max-height: 200px; overflow-y: auto;"></div>
      </div>
      <div class="modal-footer">
        <button id="confirmDataBtn" class="btn-submit">Konfirmasi</button>
        <button id="cancelDataBtn" class="btn-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Modal Lot Increment Notification -->
  <div id="lotIncrementModal" class="modal">
    <div class="modal-content modal-success">
      <div class="modal-header">
        <h2>‚úÖ LOT SELESAI</h2>
      </div>
      <div class="modal-body" style="text-align: center;">
        <p style="font-size: 20px; font-weight: bold; color: var(--success-color);">
          Lot <span id="completedLotNumber"></span> Selesai!
        </p>
        <p style="font-size: 16px; margin-top: 10px;">
          Melanjutkan ke Lot <span id="nextLotNumber"></span>
        </p>
      </div>
    </div>
  </div>

  <!-- Modal Completion Summary -->
  <div id="completionModal" class="modal">
    <div class="modal-content modal-success">
      <div class="modal-header">
        <h2>üéâ SEMUA LOT SELESAI</h2>
      </div>
      <div class="modal-body" style="text-align: left;">
        <p style="font-size: 18px; font-weight: bold; color: var(--success-color); text-align: center; margin-bottom: 15px;">
          Pekerjaan Selesai!
        </p>
        <hr style="margin: 15px 0; border: 1px solid #334155;">
        <p><strong>Nomor MO:</strong> <span id="summaryMONumber"></span></p>
        <p><strong>Total Lot Diselesaikan:</strong> <span id="summaryTotalLot"></span></p>
        <p><strong>Jumlah Produk RM:</strong> <span id="summaryRMCount"></span></p>
        <p><strong>Total Item Ditimbang:</strong> <span id="summaryTotalItems"></span></p>
        <hr style="margin: 15px 0; border: 1px solid #334155;">
        <p style="text-align: center; color: var(--text-secondary);">
          MO akan direset otomatis
        </p>
      </div>
      <div class="modal-footer">
        <button id="completionOkBtn" class="btn-submit">OK</button>
      </div>
    </div>
  </div>
  
  <script src="js/app.js"></script>
</body>
</html>
